(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(e,t,a){e.exports=a(31)},30:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),s=a.n(o),c=a(3),l=a.n(c),i=a(10),u=a(4),d=a(1),p=a(2);var m=function(){var e=Object(n.useState)(!0),t=Object(d.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)((function(){setTimeout((function(){o(!1)}),1e3)}),[]),a?r.a.createElement("div",{className:"NavBar"},r.a.createElement("div",{className:"LogoText LogoTextLoading"})):r.a.createElement("div",{className:"NavBar"},r.a.createElement("div",{className:"LogoText"},r.a.createElement("h1",null,r.a.createElement("span",{className:"LogoFirstHalf"},"Demo"),r.a.createElement("span",{className:"LogoSecondHalf"},"Card"))))};function g(){var e=Object(n.useState)(!0),t=Object(d.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)((function(){setTimeout((function(){o(!1)}),2e3)}),[]),a?r.a.createElement("div",{className:"Loader_Information"},r.a.createElement("div",{className:"LI_Header"}),r.a.createElement("div",{className:"LI_Para"}),r.a.createElement("div",{className:"LI_Header"}),r.a.createElement("div",{className:"LI_Para"})):r.a.createElement("div",{className:"Information"},r.a.createElement("h1",null,"About this little project"),r.a.createElement("p",null,"This is a demo app created by me for the purpose of learning Basics of ",r.a.createElement("strong",null,"GraphQl")),r.a.createElement("h1",{className:"I_h1_2"},"Technology Used"),r.a.createElement("p",null,"React(hooks), ",r.a.createElement("strong",null,"GraphQl(Apollo)"),", Nodejs, MongoDB"))}function f(e){var t=e.toggleToAccount,a=e.accountToggleHandler,o=Object(n.useState)(!0),s=Object(d.a)(o,2),c=s[0],l=s[1];return Object(n.useEffect)((function(){setTimeout((function(){l(!1)}),2500)}),[]),c?r.a.createElement("div",{className:"Loader_Toggle"},r.a.createElement("div",null),r.a.createElement("div",null)):r.a.createElement("div",{className:"Toggle"},r.a.createElement("button",{className:t?"Toggle_Button":"Toggle_Button ToggleActiveButton",onClick:function(){if(!t)return null;a(!1)}},"Posts"),r.a.createElement("button",{className:t?"Toggle_Button ToggleActiveButton":"Toggle_Button",onClick:function(){if(t)return null;a(!0)}},"Account"))}a(20);var h=a(5);function b(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"loadingLineComponent"},r.a.createElement("div",{className:"loadingLineComponentOuter"},r.a.createElement("div",{className:"loadingLineComponentInner"}))))}a(26);var E=a(6);function v(){var e=Object(n.useState)(!0),t=Object(d.a)(e,2),a=t[0],o=t[1],s=Object(n.useContext)(R),c=s.state.userID,l=s.state.loggedIn,i=s.state.totalposts,u=s.state.initialLoading,p=s.LoadPostsData,m=s.initialLoadingHandler,g=s.radioAllHandler,f=Object(n.useState)(!1),h=Object(d.a)(f,2),b=h[0],v=h[1],y=Object(n.useState)(!1),j=Object(d.a)(y,2),w=j[0],k=j[1],T=Object(n.useState)(!0),P=Object(d.a)(T,2),x=P[0],S=P[1];function N(e,t){if(!l)return k(!0),void setTimeout((function(){k(!1)}),2e3);e&&e.preventDefault(),v(t)}function _(e){e.preventDefault(),l?"ALL"===e.target.value&&x||("ME"!==e.target.value||x)&&(S(!x),"ME"===e.target.value?(g(!1),p(c)):(g(!0),p(null))):N()}return Object(n.useEffect)((function(){u?setTimeout((function(){m(!1),o(!1)}),3e3):setTimeout((function(){o(!1)}),500)}),[]),a?r.a.createElement("div",{className:"Loader_TopRow"},r.a.createElement("div",{className:"LT_First"},r.a.createElement("div",null),r.a.createElement("div",{className:"LTF_Second"})),r.a.createElement("div",{className:"LT_Second"},r.a.createElement("div",{className:"LTS_PostFirst"}),r.a.createElement("div",{className:"LTS_PostSecond LTS_PostCommon"}),r.a.createElement("div",{className:"LTS_PostThird LTS_PostCommon"})),r.a.createElement("div",{className:"LT_Third"})):r.a.createElement("div",{className:"TopRow"},r.a.createElement("div",{className:"TopRow_first"},r.a.createElement("div",{className:"T_first_div"},r.a.createElement(E.a,null)),!l&&r.a.createElement("p",null,"Login to add and edit cards"),l&&r.a.createElement("p",null,"You can now edit and delete your cards")),r.a.createElement("div",{className:"TopRow_second"},r.a.createElement("p",null,"Total Posts: ",r.a.createElement("span",null,"(",i,")")),r.a.createElement("div",{className:"T_RadioFilterDiv"},r.a.createElement("input",{type:"radio",name:"filterRadio",id:"T_RF",value:"ME",checked:!x,onChange:function(e){return _(e)}}),r.a.createElement("label",{htmlFor:"T_RF"}," Mine Posts"),r.a.createElement("input",{type:"radio",name:"filterRadio",id:"T_RS",value:"ALL",checked:x,onChange:function(e){return _(e)}}),r.a.createElement("label",{htmlFor:"T_RS"}," All Posts"))),r.a.createElement("div",{className:"T_CPBDIV"},w&&r.a.createElement("p",{className:"btnToolTip toolTipOpactiy"},"Login to add/filter card"),r.a.createElement("button",{onClick:function(e){return N(e,!0)}},"Create New Card")),b&&r.a.createElement(O,{postFormHandler:N}))}var y={title:"",description:"",file:null,titlePlaceholder:"Title of the post",descriptionPlaceholder:"Write something you want me to read, here! :)"};function O(e){var t=e.postFormHandler,a=Object(n.useContext)(R),o=a.loadPostCounts,s=a.radioAll,c=Object(n.useState)(!0),i=Object(d.a)(c,2),m=(i[0],i[1],Object(n.useContext)(R).addPostHandler),g=r.a.useRef(null),f=function(e){var t=Object(n.useContext)(R).state.token,a=Object(n.useState)(e),r=Object(d.a)(a,2),o=r[0],s=r[1],c=Object(n.useState)(null),i=Object(d.a)(c,2),m=i[0],g=i[1],f=Object(n.useState)(!1),b=Object(d.a)(f,2),E=b[0],v=b[1],y=Object(n.useState)(null),O=Object(d.a)(y,2),j=O[0],w=O[1];function k(e){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(l.a.mark((function e(t){var a,n,r,o,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(null),e.prev=1,a=t.title,n=t.description,r=t.file,o={},0===a.toString().trim().length?o.titleError="title cannot be empty":a.toString().trim().length<=2&&(o.titleError="title must le at least 3 characters long"),s=0,0===n.toString().trim().length&&(o.descriptionError="description cannot be empty"),n.toString().trim().split(" ").forEach((function(e){var t=e.length;s+=t})),s>300&&(o.descriptionError="Max limit is 300 characters"),s<50&&(o.descriptionError="Min limit is 50 characters"),/\r|\n/.exec(n)&&(o.descriptionError="No line breaks allowed"),r?r&&(["image/png","image/jpeg","image/gif"].includes(r.type)||(o.fileError="Only image files are allowed")):o.fileError="Select a file",e.abrupt("return",o);case 16:return e.prev=16,e.t0=e.catch(1),(c={}).errorMessage="Something went wrong",e.abrupt("return",c);case 21:case"end":return e.stop()}}),e,null,[[1,16]])})))).apply(this,arguments)}function P(){return(P=Object(u.a)(l.a.mark((function e(a){var n,r,o,s,c,i,u,d,p,m,f,h,b,E,y;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(null),v(!0),e.prev=2,e.next=5,k(a);case 5:if(n=e.sent,!(Object.keys(n).length>0)){e.next=10;break}return g(n),v(!1),e.abrupt("return");case 10:return r=new FormData,Object.keys(a).forEach((function(e){r.append(e,a[e])})),o=a.file.type.split("/").join("."),s='mutation{\n                signUrl(fileType:"'.concat(o,'"){       \n                  ... on signedUrl{\n                    __typename\n                    signedUrlS3\n                    fileName\n                    fileUrl\n                  }\n                }\n              }\n            '),e.next=16,fetch("/graphql",{method:"POST",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"},body:JSON.stringify({query:s})});case 16:if((c=e.sent).ok){e.next=21;break}throw(i={}).errorMessage="Something went wrong",i;case 21:return e.next=23,c.json();case 23:if(u=e.sent,d=u.data){e.next=27;break}throw{errorMessage:"something went wrong"};case 27:if(!d.signUrl||d.signUrl.hasOwnProperty("__typename")||"singedUrl"!==!d.signUrl.__typename){e.next=29;break}throw{errorMessage:"something went wrong"};case 29:return p=d.signUrl,m=p.signedUrlS3,p.fileName,f=p.fileUrl,e.next=32,fetch(m,{method:"PUT",headers:{"Content-Type":o,"x-amz-acl":"public-read"},body:a.file});case 32:if(e.sent.ok){e.next=35;break}throw new Error("something went wrong");case 35:return h='mutation {\n                postPost(title: "'.concat(a.title.toString(),'", description:"').concat(a.description.toString(),'", imageURL:"').concat(f.toString(),'"){\n                  ... on Error{\n                    errorMessage\n                  }\n                  \n                  ... on Post{\n                    __typename\n                    _id\n                    description\n                    title\n                    imageURL\n                    createdBy{\n                        _id\n                        name\n                    }\n                  }\n                }\n              }'),e.next=38,fetch("/graphql",{method:"POST",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"},body:JSON.stringify({query:h})});case 38:if((b=e.sent).ok){e.next=41;break}throw new Error("some error");case 41:return e.next=43,b.json();case 43:if(E=e.sent,y=E.data.postPost){e.next=47;break}throw new Error("something surely went wrong");case 47:delete y.__typename,w(y),v(!1),e.next=57;break;case 52:e.prev=52,e.t0=e.catch(2),e.t0&&e.t0.hasOwnProperty("errorMessage")?g(e.t0):g({errorMessage:"something went wrong try again later"}),w(null),v(!1);case 57:case"end":return e.stop()}}),e,null,[[2,52]])})))).apply(this,arguments)}return{values:o,changeHandler:function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value;s("file"!==a?Object(p.a)(Object(p.a)({},o),{},Object(h.a)({},a,n)):Object(p.a)(Object(p.a)({},o),{},Object(h.a)({},a,e.target.files[0])))},submitHandler:function(e){return P.apply(this,arguments)},errors:m,loading:E,postData:j}}(y),E=f.values,v=f.changeHandler,O=f.submitHandler,j=f.loading,w=f.errors,k=f.postData;function T(e){g.current&&!g.current.contains(e.target)&&t(null,!1)}return Object(n.useEffect)((function(){return window.addEventListener("click",T),function(){window.removeEventListener("click",T)}}),[]),k?(t(null,!1),m(k),o(s),null):r.a.createElement("div",{className:"PostFormContainer PostFormHeight"},j&&r.a.createElement(b,null),r.a.createElement("form",{ref:g},r.a.createElement("input",{onChange:v,name:"title",type:"text",value:E.title,placeholder:E.titlePlaceholder}),w&&w.titleError&&r.a.createElement("p",null,w.titleError),r.a.createElement("textarea",{onChange:v,value:E.description,placeholder:E.descriptionPlaceholder,name:"description"}),w&&w.descriptionError&&r.a.createElement("p",null,w.descriptionError),r.a.createElement("input",{onChange:v,className:"fileInput",type:"file",name:"file"}),w&&w.fileError&&r.a.createElement("p",null,w.fileError),w&&w.errorMessage&&r.a.createElement("p",null,w.errorMessage),r.a.createElement("div",{className:"PF_buttonCon"},r.a.createElement("button",{onClick:function(e){e.preventDefault(),O(E)}},"submit"),r.a.createElement("button",{className:"closeLineBtn",onClick:function(e){e.preventDefault(),t(null,!1)}},"close"))))}function j(){var e=Object(n.useState)(!0),t=Object(d.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(d.a)(s,2),l=c[0],i=c[1],u=Object(n.useContext)(R),p=u.state.postsData,m=u.state.initialLoading,g=u.state.postsLoading,f=u.state.radioAll,h=u.deletePostHandler,b=u.loadPostCounts;function E(){var e=window.innerWidth;i(e>768)}return Object(n.useEffect)((function(){return window.addEventListener("resize",E),E(),setTimeout((function(){o(!1)}),1e3),function(){window.removeEventListener("resize",E)}}),[]),m||g||a?r.a.createElement("ul",{className:"Loader_PostCard"},[1,2,3,4,5,6,7,8].map((function(e){return r.a.createElement(x,{key:e})}))):r.a.createElement("div",{className:"PostCard"},!f&&0===p.length&&r.a.createElement("p",{className:"message"},"You have no cards, create one!"),!l&&p&&r.a.createElement("ul",{className:"PostCard_firstColumn"},p.map((function(e){return r.a.createElement(w,{key:e._id,post:e,deletePostHandler:h,radioAll:f,loadPostCounts:b})}))),l&&p&&r.a.createElement("ul",{className:"PostCard_firstColumn"},p.map((function(e,t){return(t+1)%2!==0?r.a.createElement(w,{key:e._id,post:e,deletePostHandler:h,radioAll:f,loadPostCounts:b}):null}))),l&&p&&r.a.createElement("ul",{className:"PostCard_secondColumn"},p.map((function(e,t){return(t+1)%2===0?r.a.createElement(w,{key:e._id,post:e,deletePostHandler:h,radioAll:f,loadPostCounts:b}):null}))))}function w(e){var t=e.post,a=e.deletePostHandler,o=e.radioAll,s=e.loadPostCounts,c=t.imageURL,i=t.title,m=t.description,g=t.createdBy,f=t._id,E=function(){var e=Object(n.useContext)(R).state.token,t=Object(n.useState)(null),a=Object(d.a)(t,2),r=a[0],o=a[1],s=Object(n.useState)(!1),c=Object(d.a)(s,2),i=c[0],p=c[1],m=Object(n.useState)(!1),g=Object(d.a)(m,2),f=g[0],h=g[1],b=Object(n.useState)(null),E=Object(d.a)(b,2),v=E[0],y=E[1];function O(){return(O=Object(u.a)(l.a.mark((function t(a,n){var r,s,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(!1),o(null),h(!0),t.prev=3,r='mutation{\n                deletePost(_id: "'.concat(a,'", fileName: "').concat(n,'")\n            }'),t.next=7,fetch("/graphql",{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({query:r})});case 7:if((s=t.sent).ok){t.next=10;break}throw new Error("to catch block");case 10:return t.next=12,s.json();case 12:if(c=t.sent,(i=c.data)||i.deletePost){t.next=16;break}throw new Error("to catch block");case 16:y(a),p(!0),h(!1),t.next=27;break;case 21:t.prev=21,t.t0=t.catch(3),o("Something went wrong, Try again Later!"),y(null),p(!1),h(!1);case 27:case"end":return t.stop()}}),t,null,[[3,21]])})))).apply(this,arguments)}return{deletePostMethod:function(e,t){return O.apply(this,arguments)},postDeleted:i,deleteErrorMessage:r,deleteLoading:f,deletedPostId:v}}(),v=E.deleteErrorMessage,y=E.deletePostMethod,O=E.postDeleted,j=E.deleteLoading,w=E.deletedPostId,x=function(){var e=Object(n.useContext)(R),t=e.state.token,a=e.updatingDescriptionHandler,r=Object(n.useState)(null),o=Object(d.a)(r,2),s=o[0],c=o[1],i=Object(n.useState)(!1),p=Object(d.a)(i,2),m=p[0],g=p[1],f=Object(n.useState)(!1),h=Object(d.a)(f,2),b=h[0],E=h[1];function v(){return(v=Object(u.a)(l.a.mark((function e(n,r){var o,s,i,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("currentDescription",r),c(null),g(!1),c(null),E(!0),e.prev=5,o=0,0!==r.toString().trim().length){e.next=9;break}throw{errorMessage:"description cannot be empty"};case 9:if(r.toString().trim().split(" ").forEach((function(e){var t=e.length;o+=t})),!(o>300)){e.next=12;break}throw{errorMessage:"Max limit is 300 characters"};case 12:if(!(o<50)){e.next=14;break}throw{errorMessage:"Min limit is 50 characters"};case 14:if(!/\r|\n/.exec(r)){e.next=17;break}throw{errorMessage:"No line breaks allowed"};case 17:return s='mutation{\n                updatePost(_id: "'.concat(n,'", description: "').concat(r.trim(),'")\n            }'),e.next=20,fetch("/graphql",{method:"POST",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"},body:JSON.stringify({query:s})});case 20:if((i=e.sent).ok){e.next=23;break}throw new Error("to catch block");case 23:return e.next=25,i.json();case 25:if(u=e.sent,(d=u.data)||d.updatePost){e.next=29;break}throw new Error("to catch block");case 29:g(!0),E(!1),a(n,r),e.next=39;break;case 34:e.prev=34,e.t0=e.catch(5),e.t0.errorMessage?c(e.t0.errorMessage):c("Something went wrong, Try again Later!"),g(!1),E(!1);case 39:case"end":return e.stop()}}),e,null,[[5,34]])})))).apply(this,arguments)}return{updateErrorMessage:s,updatePostMethod:function(e,t){return v.apply(this,arguments)},postUpdated:m,updateLoading:b}}(),S=x.updateErrorMessage,N=x.updatePostMethod,_=x.postUpdated,L=x.updateLoading,C=Object(n.useState)(!1),D=Object(d.a)(C,2),I=D[0],M=D[1],U=Object(n.useState)({}),A=Object(d.a)(U,2),H=A[0],B=A[1];return Object(n.useEffect)((function(){B({updateTitle:i,updateDescription:m})}),[]),O&&(a(null,w),s(o)),r.a.createElement("li",{className:"PostCard_PostList"},(L||j)&&r.a.createElement(b,null),r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{imageURL:c}),r.a.createElement(k,{description:m,createdBy:g,title:i,showUpdateFields:I,valuesToUpdate:H,updateChangeHandler:function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value,r=Object(p.a)(Object(p.a)({},H),{},Object(h.a)({},a,n));B(r)},postUpdated:_,deleteErrorMessage:v,updateErrorMessage:S}),r.a.createElement(P,{_id:f,imageURL:c,createdBy:g,deletePostMethod:y,updatePostMethod:N,updateClickHandler:function(e){"EDIT"===e?M(!0):"UPDATE"===e&&(M(!1),N(f,H.updateDescription))},showUpdateFields:I})))}function k(e){var t=e.deleteErrorMessage,a=e.updateErrorMessage,o=(e.postUpdated,e.updateChangeHandler),s=e.valuesToUpdate,c=e.showUpdateFields,l=e.description,i=e.createdBy,u=e.title,d=Object(n.useContext)(R),p=d.state.userID,m=d.state.loggedIn;return r.a.createElement("div",{className:"Description"},r.a.createElement("h1",null,u&&u.replace(u.charAt(0),u.charAt(0).toUpperCase())),r.a.createElement("h3",null,"Post By :",m&&p&&p.toString()===i._id.toString()?" You":" "+i.name.replace(i.name.charAt(0),i.name.charAt(0).toUpperCase())),a&&r.a.createElement("p",{className:"errorMessage"},a),t&&r.a.createElement("p",{className:"errorMessage"},t),c?r.a.createElement("textarea",{name:"updateDescription",onChange:function(e){o(e)},value:s.updateDescription}):r.a.createElement("p",null,l&&l.replace(l.charAt(0),l.charAt(0).toUpperCase())))}function T(e){var t=e.imageURL,a=Object(n.useState)(!1),o=Object(d.a)(a,2),s=o[0],c=o[1];return r.a.createElement("div",{className:"Picture"},!s&&r.a.createElement("div",{className:"lazyLoading"},r.a.createElement(E.c,null)),r.a.createElement("img",{style:s?{}:{display:"none"},src:t,onLoad:function(e){return c(!0)}}))}function P(e){var t=e.showUpdateFields,a=e.updateClickHandler,o=e._id,s=e.imageURL,c=e.createdBy,l=e.deletePostMethod,i=Object(n.useContext)(R),u=i.state.userID;return!i.state.loggedIn||u&&c._id.toString()!==u.toString()?null:r.a.createElement("div",{className:"PostButtons"},t?r.a.createElement("button",{className:"PostButtons_button",onClick:function(e){return a("UPDATE")}},"Update"):r.a.createElement("button",{className:"PostButtons_button",onClick:function(e){return a("EDIT")}},"Edit"),r.a.createElement("button",{className:"PostButtons_button deleteBtn",onClick:function(e){return l(o,s)}},"Delete"))}function x(){return r.a.createElement("li",null,r.a.createElement("div",null,r.a.createElement(E.c,null)),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null,r.a.createElement("div",null),r.a.createElement("div",null)))}var S={email:"",password:"",emailPlaceholder:"youremail@gmail.com",passwordPlaceholder:"**********"},N={email:"",password:"",username:"",usernamePlaceholder:"Username",emailPlaceholder:"youremail@gmail.com",passwordPlaceholder:"**********"};function _(){var e=Object(n.useContext)(R),t=e.state.loggedIn,a=e.logoutHandler,o=Object(n.useState)(!1),s=Object(d.a)(o,2),c=s[0],l=s[1];return t?r.a.createElement("div",{className:"alreadyIn"},r.a.createElement("p",null,"You are already loggedIn!!"),r.a.createElement("button",{className:"logoutButton",onClick:function(e){e.preventDefault(),a()}},"Logout")):r.a.createElement("div",{className:"Form"},!c&&r.a.createElement(L,{setRegister:l}),c&&r.a.createElement(C,{setRegister:l}))}function L(e){var t=e.setRegister,a=Object(n.useContext)(R).loginHandler,o=function(e){var t=Object(n.useState)(e),a=Object(d.a)(t,2),r=a[0],o=a[1],s=Object(n.useState)({}),c=Object(d.a)(s,2),i=c[0],m=c[1],g=Object(n.useState)(!1),f=Object(d.a)(g,2),b=f[0],E=f[1],v=Object(n.useState)(null),y=Object(d.a)(v,2),O=y[0],j=y[1],w=Object(n.useState)(!1),k=Object(d.a)(w,2),T=k[0],P=k[1];function x(){return(x=Object(u.a)(l.a.mark((function e(t,a){var n,r,o,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),t.preventDefault(),m({}),n='mutation {\n                             signInUser(email: "'.concat(a.email,'", password: "').concat(a.password,'") \n                                {   \n                                    __typename\n                                    ... on Error{\n                                    errorMessage\n                                  }\n                                  \n                                  ... on accessResponse{\n                                    refreshToken\n                                    accessToken\n                                  }\n                                }\n                            }'),e.prev=4,e.next=7,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:n})});case 7:if((r=e.sent).ok){e.next=12;break}throw(o={}).errorMessage="Something went wrong",o;case 12:return e.next=14,r.json();case 14:if(s=e.sent,c=s.data){e.next=18;break}throw{errorMessage:"Something went wrong"};case 18:if("Error"!==c.signInUser[0].__typename){e.next=20;break}throw c.signInUser[0];case 20:document.cookie="refreshToken="+c.signInUser[0].refreshToken,document.cookie="accessToken="+c.signInUser[0].accessToken,P(!1),E(!0),j(c.signInUser[0].accessToken),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(4),e.t0&&e.t0.hasOwnProperty("errorMessage")?m(e.t0):m({errorMessage:"something went wrong try again later"}),P(!1);case 31:case"end":return e.stop()}}),e,null,[[4,27]])})))).apply(this,arguments)}return{values:r,changeHandler:function(e){e.preventDefault();var t=e.target.name,a=e.target.value;o((function(e){return Object(p.a)(Object(p.a)({},e),{},Object(h.a)({},t,a))}))},submitHandler:function(e,t){return x.apply(this,arguments)},errors:i,loggedIn:b,token:O,loading:T}}(S),s=o.values,c=o.changeHandler,i=o.submitHandler,m=o.errors,g=o.loggedIn,f=o.token,E=o.loading;return g&&setTimeout((function(){a(!0,f)}),300),E?r.a.createElement(b,null):r.a.createElement("form",{className:"LoginForm",onSubmit:function(e){e.preventDefault(),t(!0)}},m&&m.errorMessage&&r.a.createElement("p",{className:"errorMessageP"},m.errorMessage),r.a.createElement("input",{onChange:function(e){return c(e)},type:"email",name:"email",placeholder:s&&s.emailPlaceholder,values:s.email}),r.a.createElement("input",{onChange:function(e){return c(e)},type:"password",name:"password",placeholder:s&&s.passwordPlaceholder,values:s.password}),r.a.createElement("div",null,r.a.createElement("button",{className:"Login_button",onClick:function(e){i(e,s)}},"Login"),r.a.createElement("button",{className:"Register_link",type:"submit"},"Signup")))}function C(e){var t=e.setRegister,a=function(e){var t=Object(n.useState)(e),a=Object(d.a)(t,2),r=a[0],o=a[1],s=Object(n.useState)({}),c=Object(d.a)(s,2),i=c[0],m=c[1],g=Object(n.useState)(null),f=Object(d.a)(g,2),b=f[0],E=f[1],v=Object(n.useState)(null),y=Object(d.a)(v,2),O=y[0],j=y[1];function w(){return(w=Object(u.a)(l.a.mark((function e(t,a){var n,r,o,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),t.preventDefault(),m({}),n='mutation {\n                        signUpUser(email:"'.concat(a.email,'", username:"').concat(a.username,'", password: "').concat(a.password,'"){\n                            __typename\n                            ... on Error{\n                            errorMessage\n                            }\n                            ... on trueORfalse{\n                            ok\n                            }\n                        }                \n                    }'),e.prev=4,e.next=7,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:n})});case 7:if((r=e.sent).ok){e.next=12;break}throw(o={}).errorMessage="Something went wrong",o;case 12:return e.next=14,r.json();case 14:if(s=e.sent,c=s.data){e.next=18;break}throw{errorMessage:"Something went wrong"};case 18:if("Error"!==c.signUpUser.__typename){e.next=20;break}throw{errorMessage:c.signUpUser.errorMessage};case 20:c.signUpUser.ok&&(E(!0),j(!1)),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(4),e.t0&&e.t0.hasOwnProperty("errorMessage")?m(e.t0):m({errorMessage:"something went wrong try again later"}),j(!1);case 27:case"end":return e.stop()}}),e,null,[[4,23]])})))).apply(this,arguments)}return{values:r,changeHandler:function(e){e.preventDefault();var t=e.target.name,a=e.target.value;o((function(e){return Object(p.a)(Object(p.a)({},e),{},Object(h.a)({},t,a))}))},errors:i,registerHandler:function(e,t){return w.apply(this,arguments)},registered:b,loading:O}}(N),o=a.values,s=a.changeHandler,c=a.errors,i=a.registerHandler,m=a.registered,g=a.loading;return m&&t(!1),g?r.a.createElement(b,null):r.a.createElement("form",{className:"RegisterForm",onSubmit:function(e){e.preventDefault(),t(!1)}},c&&c.errorMessage&&r.a.createElement("p",{className:"errorMessageP"},c.errorMessage),r.a.createElement("input",{onChange:function(e){return s(e)},type:"string",name:"username",value:o.username,placeholder:o.usernamePlaceholder}),r.a.createElement("input",{onChange:function(e){return s(e)},name:"email",type:"email",value:o.email,placeholder:o.emailPlaceholder}),r.a.createElement("input",{onChange:function(e){return s(e)},name:"password",type:"password",value:o.password,placeholder:o.passwordPlaceholder}),r.a.createElement("div",null,r.a.createElement("button",{className:"Register_button",onClick:function(e){return i(e,o)}}," SignUp"),r.a.createElement("button",{className:"Login_link",type:"submit"},"Login")))}function D(e){var t=e.graphiqlLink,a=Object(n.useState)(!0),o=Object(d.a)(a,2),s=o[0],c=o[1];return Object(n.useEffect)((function(){setTimeout((function(){c(!1)}),1500)}),[]),s?r.a.createElement("div",{className:"graphiqlButton"},r.a.createElement("div",{className:"GraphQLBtnLoader"})):r.a.createElement("div",{className:"graphiqlButton"},r.a.createElement("button",{onClick:function(e){e.preventDefault(),window.open(t,"_blank")}},r.a.createElement("span",null,"Graphiql Playground"),r.a.createElement(E.b,null)))}var I=a(11),M=a.n(I),U=function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n,r,o,s,c,i,u,d,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=A("accessToken"),a=A("refreshToken"),t&&a){e.next=5;break}throw new Error("no access");case 5:if(n=M()(t),r=n.userID,n.userType,n.tokenType,o=n.exp){e.next=8;break}throw new Error("no access");case 8:if(s=H(o)){e.next=11;break}return e.abrupt("return",{token:t,loggedIn:!0,userID:r});case 11:if(!s){e.next=19;break}if(c=M()(a),i=c.userID,c.userType,c.tokenType,u=c.exp){e.next=15;break}throw new Error("no access");case 15:if(H(u)){e.next=18;break}return e.abrupt("return",{token:a,loggedIn:!0,userID:i});case 18:throw new Error("no access");case 19:e.next=28;break;case 21:return e.prev=21,e.t0=e.catch(0),d=A("accessToken"),p=A("refreshToken"),B(d),B(p),e.abrupt("return",{token:null,loggedIn:!1,userID:null});case 28:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}();function A(e){for(var t=e+"=",a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function H(e){return(new Date).getTime()>1e3*e}function B(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")}a(30);var R=Object(n.createContext)();function q(e,t){switch(t.type){case"toggleToAccount":return Object(p.a)(Object(p.a)({},e),{},{toggleToAccount:t.payload});case"loggedIn":return Object(p.a)(Object(p.a)({},e),{},{loggedIn:t.payload});case"userID":return Object(p.a)(Object(p.a)({},e),{},{userID:t.payload});case"token":return Object(p.a)(Object(p.a)({},e),{},{token:t.payload});case"postsData":return Object(p.a)(Object(p.a)({},e),{},{postsData:t.payload});case"totalposts":return Object(p.a)(Object(p.a)({},e),{},{totalposts:t.payload});case"deletePosts":return Object(p.a)({},e);case"addPost":return Object(p.a)(Object(p.a)({},e),{},{postsData:t.payload});case"postsLoading":return Object(p.a)(Object(p.a)({},e),{},{postsLoading:t.payload});case"initialLoading":return Object(p.a)(Object(p.a)({},e),{},{initialLoading:t.payload});case"radioAll":return Object(p.a)(Object(p.a)({},e),{},{radioAll:t.payload});default:return e}}var F={toggleToAccount:!1,loggedIn:!1,userID:null,token:null,totalposts:null,postsData:null,postsLoading:!1,initialLoading:!0,radioAll:!0,graphiqlLink:"/graphql"};var J=function(){var e=Object(n.useReducer)(q,F),t=Object(d.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!0),c=Object(d.a)(s,2),p=(c[0],c[1],Object(n.useState)(!1)),h=Object(d.a)(p,2),b=h[0],E=h[1],y=Object(n.useState)(null),O=Object(d.a)(y,2),w=(O[0],O[1]),k=Object(n.useState)(!1),T=Object(d.a)(k,2),P=T[0],x=T[1];function S(){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U();case 3:t=e.sent,a=t.token,n=t.loggedIn,r=t.userID,n?(o({type:"loggedIn",payload:n}),o({type:"token",payload:a}),o({type:"userID",payload:r})):(o({type:"token",payload:null}),o({type:"loggedIn",payload:!1}),o({type:"userID",payload:null})),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function L(e){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(l.a.mark((function e(t){var a,n,r,s,c,i,u,p,m,g,f,h,b,E,v,y,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"postsLoading",payload:!0}),a={limit:100,skip:0,asc:-1,userID:null},t&&(a.userID=t),e.prev=3,n=a.limit,r=a.skip,s=a.asc,c=a.userID,i="query {\n          posts(limit:".concat(n,", skip: ").concat(r,", asc: ").concat(s,', userID: "').concat(c,'"){\n                __typename\n                ... on Error{\n                  errorMessage\n                }\n                ... on Post{\n                  _id\n                  title\n                  description\n                  createdAt\n                  updatedAt\n                  imageURL\n                  createdBy{\n                    _id\n                    name\n                  }\n                }\n          }\n      }\n        '),u='query {\n            totalPosts(userID: "'.concat(c,'"){\n            __typename\n            ... on TotalPost{\n              count\n            }\n         }\n       }\n       '),p=function(){return fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:i,variables:{}})})},m=function(){return fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:u})})},e.next=11,Promise.all([p(),m()]);case 11:if(g=e.sent,f=Object(d.a)(g,2),h=f[0],b=f[1],h.ok&&b.ok){e.next=17;break}throw new Error("oops");case 17:return e.next=19,h.json();case 19:return E=e.sent,e.next=22,b.json();case 22:if(v=e.sent,E.data.posts&&v.data.totalPosts){e.next=25;break}throw new Error("oops, handled by cath//");case 25:y=E.data.posts,O=v.data.totalPosts.count,o({type:"postsData",payload:y}),o({type:"totalposts",payload:O}),setTimeout((function(){o({type:"postsLoading",payload:!1})}),1e3),e.next=37;break;case 32:e.prev=32,e.t0=e.catch(3),console.log("error",e.t0),w({oopsError:"something definately went wrong okay :) "}),setTimeout((function(){o({type:"postsLoading",payload:!1})}),1e3);case 37:case"end":return e.stop()}}),e,null,[[3,32]])})))).apply(this,arguments)}function I(e){o({type:"toggleToAccount",payload:e})}function M(){return(M=Object(u.a)(l.a.mark((function e(t){var n,r,s,c,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?a.userID:null,e.prev=1,r='query {\n          totalPosts(userID: "'.concat(n,'"){\n          __typename\n          ... on TotalPost{\n            count\n              }\n            }\n          }'),s=function(){return fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})})},e.next=6,s();case 6:if((c=e.sent).ok){e.next=9;break}throw new Error("oops");case 9:return e.next=11,c.json();case 11:if((i=e.sent).data.totalPosts){e.next=14;break}throw new Error("oops, handled by cath//");case 14:u=i.data.totalPosts.count,o({type:"totalposts",payload:u}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("oops, couldnot get the count right now try later :)");case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){var e;return b&&(e=setInterval((function(){S()}),3e3),setTimeout((function(){var t;t=e,window.clearInterval(t),x(!P)}),5e3)),b||(S(),L(null),E(!0),setTimeout((function(){x(!P)}),3e3)),function(){window.clearInterval(e)}}),[P]),r.a.createElement("div",{className:"App"},r.a.createElement(m,null),r.a.createElement(R.Provider,{value:{state:a,loginHandler:function(e,t){o({type:"loggedIn",payload:e}),I(!1),o({type:"token",payload:t})},logoutHandler:function(){document.cookie="refreshToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="accessToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",o({type:"loggedIn",payload:!1})},deletePostHandler:function(e,t){console.log("_id",t),e&&e.preventDefault();var n=Object(i.a)(a.postsData).filter((function(e){return e._id.toString()!==t.toString()}));o({type:"postsData",payload:n})},addPostHandler:function(e){var t=[e].concat(Object(i.a)(a.postsData));o({type:"addPost",payload:t})},LoadPostsData:L,initialLoadingHandler:function(e){o({type:"initialLoading",action:e})},loadPostCounts:function(e){return M.apply(this,arguments)},radioAllHandler:function(e){o({type:"radioAll",payload:e})},updatingDescriptionHandler:function(e,t){var n=Object(i.a)(a.postsData),r=n.findIndex((function(t){return t._id.toString()===e.toString()}));n[r].description=t,o({type:"postsData",payload:n})}}},r.a.createElement(D,{graphiqlLink:a.graphiqlLink}),r.a.createElement(g,null),r.a.createElement(f,{accountToggleHandler:I,toggleToAccount:a.toggleToAccount}),a&&!a.toggleToAccount&&r.a.createElement(v,null),a&&!a.toggleToAccount&&r.a.createElement(j,null),a&&a.toggleToAccount&&r.a.createElement(_,null)))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.2cef04b6.chunk.js.map